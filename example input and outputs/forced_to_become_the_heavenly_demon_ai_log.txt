Log saved at: 2026-01-02 19:04:25
Output Excel: forced_to_become_the_heavenly_demon_ai
Log file: forced_to_become_the_heavenly_demon_ai_log.txt
============================================================

Configuration saved to config.json
Configuration saved to config.json
============================================================
STARTING NOUN EXTRACTION PIPELINE
Genre: modern (Korean modern day novels)
============================================================

--- STEP 1: Loading and merging nouns ---
  Loaded 37 existing nouns.
No reference file found or specified. Skipping reference loading.
  No reference nouns found or reference file is empty
Saved 37 nouns to assistant_manager_kim_local.json
Found 210 text files in 'assistant_manager_kim'.
--- Skipping Step 1: There are no hanja in brackets in the novel text. ---

--- STEP 2: Using Local NER Model for entity extraction ---
Running local NER model...

Local NER Configuration loaded.
  - Novel directory: assistant_manager_kim
  - Model path: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_model
  - Output directory: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_output

Running local NER pipeline...
Initializing Korean NER Processor
Loading model from: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_model
Korean NER Processor initialized

============================================================
STARTING NOVEL PROCESSING
============================================================
Found 210 files in novel directory
Read all files. Merged text length: 1062486 characters
Split into 2140 chunk(s) for processing
Starting keyword analysis...
Processing in 67 batches (batch size: 32)
Keyword analysis completed. Found 3472 entities total

Simplified glossary exported to: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_output\glossary.json
  - Unique entries: 246
No master_nouns provided, returning 246 mapped entries

--- STEP 2a: Calculating frequencies and filtering ---
  Using merged text from glossary (length: 1062486 chars)
  Calculating frequencies for 246 nouns...

--- Performing frequency count across all files ---
  Total text length: 1,062,382 characters
  Frequency count complete.

--- STEP 2b: Running ambiguity detection ---
Running ambiguity detection on 246 nouns...
Dictionary cache contains 177 entries
Ambiguity detection complete:
  - Total entries kept: 241
  - Ambiguous entries: 136
  - Dictionary cache now contains 266 entries
  - Ambiguity rate: 56.4%

--- Sorting nouns by ambiguity, length, and frequency ---
  Sorted 241 nouns
  Clear entries: 105, Ambiguous entries: 136
Saved 241 nouns to assistant_manager_kim_local.json

--- STEP 3: Categorizing nouns with AI ---

--- Starting AI categorization for 241 nouns ---
--- All nouns already categorized, skipping AI ---
Saved 241 nouns to assistant_manager_kim_local.json

--- STEP 4: Translating to English with AI ---

--- Starting AI translation for 241 nouns (skipping 0 already translated) ---
  Processing batch 1/5 (50 nouns)
  Processing batch 2/5 (50 nouns)
  Processing batch 3/5 (50 nouns)
  Processing batch 4/5 (50 nouns)
  Processing batch 5/5 (41 nouns)
--- AI translation complete ---
Saved 241 nouns to assistant_manager_kim_local.json

--- STEP 5: Guessing missing Hanja with AI ---
You chose not to guess missing Hanja with AI.

--- STEP 6: Converting to Simplified Chinese ---
You chose not to convert to Simplified Chinese.

--- STEP 7: Creating Excel file ---

Exporting to Excel files...
  Total entries: 241
  Full Glossary entries: 105
  ambiguous terms entries: 136

Creating master Excel file: assistant_manager_kim_local_largeScale_master.xlsx
  - Full Glossary entries: 105 rows
  - ambiguous terms entries: 136 rows
  âœ“ Master file created successfully

Creating main Excel file: assistant_manager_kim_local_largeScale.xlsx
  - character names: 32 entries, total frequency: 8511
  - character titles: 50 entries, total frequency: 2379
  - skills and techniques: 7 entries, total frequency: 935
  - locations and organizations: 8 entries, total frequency: 144
  - item names: 7 entries, total frequency: 32
  - misc: 1 entries, total frequency: 4
  - Ambiguous terms: 136 entries
  âœ“ Main file created successfully with 6 category worksheet(s)

ðŸ“Š Final Statistics:
   Total nouns: 241
   - character names: 32 entries, total frequency: 8511
   - character titles: 50 entries, total frequency: 2379
   - skills and techniques: 7 entries, total frequency: 935
   - locations and organizations: 8 entries, total frequency: 144
   - item names: 7 entries, total frequency: 32
   - misc: 1 entries, total frequency: 4
   - Ambiguous terms: 136 entries

============================================================
NOVEL GLOSSARY MAKER COMPLETED SUCCESSFULLY!
============================================================

Log saved to: assistant_manager_kim_local_largeScale_log.txt
Configuration saved to config.json
Configuration saved to config.json
============================================================
STARTING NOUN EXTRACTION PIPELINE
Genre: murim (Korean modern day novels)
============================================================

--- STEP 1: Loading and merging nouns ---
  Loaded 0 existing nouns.
  Added 562 new nouns from reference file
Saved 562 nouns to forced_to_become_the_heavenly_demon_local.json
Found 10 text files in 'forced_to_become_the_heavenly_demon'.
 - Option: Regex extraction on entire novel text
  Regex found 40 potential hanja nouns in entire novel.
Saved 598 nouns to forced_to_become_the_heavenly_demon_local.json
  Preserved 562 existing, added 36 new

--- STEP 2: Using Local NER Model for entity extraction ---
Running local NER model...

Local NER Configuration loaded.
  - Novel directory: forced_to_become_the_heavenly_demon
  - Model path: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_model
  - Output directory: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_output

Running local NER pipeline...
Initializing Korean NER Processor
Loading model from: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_model
Korean NER Processor initialized

============================================================
STARTING NOVEL PROCESSING
============================================================
Found 10 files in novel directory
Read all files. Merged text length: 62212 characters
Split into 125 chunk(s) for processing
Starting keyword analysis...
Processing in 4 batches (batch size: 32)
Keyword analysis completed. Found 1015 entities total

Simplified glossary exported to: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_output\glossary.json
  - Unique entries: 203
Merged glossary: 598 master + 136 new = 734 total
  (Skipped 67 duplicate hanguls)
  (Category mapping applied to 136 new entries)

--- STEP 2a: Calculating frequencies and filtering ---
  Using merged text from glossary (length: 62212 chars)
  Calculating frequencies for 734 nouns...

--- Performing frequency count across all files ---
  Total text length: 62,212 characters
  Frequency count complete.
  Removed 488 nouns with frequency 0

--- STEP 2b: Running ambiguity detection ---
Running ambiguity detection on 246 nouns...
Dictionary cache contains 266 entries
Ambiguity detection complete:
  - Total entries kept: 235
  - Ambiguous entries: 48
  - Dictionary cache now contains 266 entries
  - Ambiguity rate: 20.4%

--- Sorting nouns by ambiguity, length, and frequency ---
  Sorted 235 nouns
  Clear entries: 187, Ambiguous entries: 48
Saved 235 nouns to forced_to_become_the_heavenly_demon_local.json

--- STEP 3: Categorizing nouns with AI ---

--- Starting AI categorization for 235 nouns ---
  Processing 14 nouns that need categorization
  Processing batch 1/1 (14 nouns)
--- AI categorization complete ---
Saved 235 nouns to forced_to_become_the_heavenly_demon_local.json

--- STEP 4: Translating to English with AI ---

--- Starting AI translation for 161 nouns (skipping 74 already translated) ---
  Processing batch 1/4 (50 nouns)
  Processing batch 2/4 (50 nouns)
  Processing batch 3/4 (50 nouns)
  Processing batch 4/4 (11 nouns)
--- AI translation complete ---
Saved 235 nouns to forced_to_become_the_heavenly_demon_local.json

--- STEP 5: Guessing missing Hanja with AI ---
You chose not to guess missing Hanja with AI.

--- STEP 6: Converting to Simplified Chinese ---
You chose not to convert to Simplified Chinese.

--- STEP 7: Creating Excel file ---

Exporting to Excel files...
  Total entries: 235
  Full Glossary entries: 187
  ambiguous terms entries: 48

Creating master Excel file: forced_to_become_the_heavenly_demon_local_master.xlsx
  - Full Glossary entries: 187 rows
  - ambiguous terms entries: 48 rows
  âœ“ Master file created successfully

Creating main Excel file: forced_to_become_the_heavenly_demon_local.xlsx
  - character names: 28 entries, total frequency: 240
  - character titles: 61 entries, total frequency: 858
  - skills and techniques: 58 entries, total frequency: 588
  - locations and organizations: 23 entries, total frequency: 182
  - item names: 2 entries, total frequency: 15
  - misc: 15 entries, total frequency: 88
  - Ambiguous terms: 48 entries
  âœ“ Main file created successfully with 6 category worksheet(s)

ðŸ“Š Final Statistics:
   Total nouns: 235
   - character names: 28 entries, total frequency: 240
   - character titles: 61 entries, total frequency: 858
   - skills and techniques: 58 entries, total frequency: 588
   - locations and organizations: 23 entries, total frequency: 182
   - item names: 2 entries, total frequency: 15
   - misc: 15 entries, total frequency: 88
   - Ambiguous terms: 48 entries

============================================================
NOVEL GLOSSARY MAKER COMPLETED SUCCESSFULLY!
============================================================

Log saved to: forced_to_become_the_heavenly_demon_local_log.txt
Configuration saved to config.json
Configuration saved to config.json
============================================================
STARTING NOUN EXTRACTION PIPELINE
Genre: murim (Korean modern day novels)
============================================================

--- STEP 1: Loading and merging nouns ---
  Loaded 0 existing nouns.
  Added 562 new nouns from reference file
Saved 562 nouns to forced_to_become_the_heavenly_demon_ai.json
Found 10 text files in 'forced_to_become_the_heavenly_demon'.
 - Option: Regex extraction on entire novel text
  Regex found 40 potential hanja nouns in entire novel.
Saved 598 nouns to forced_to_become_the_heavenly_demon_ai.json
  Preserved 562 existing, added 36 new

--- STEP 2: AI extraction by chunks (Gemini) ---

--- Step 2: AI extraction on 2 chunks ---
  Grouped files into 2 chunks of up to 5 files each.

--- Processing AI chunk 1/2 ---
  Files: ['001.txt', '002.txt', '003.txt', '004.txt', '005.txt']
  Attempt 1/3 for AI discovery...
  AI discovered 10 new nouns in this chunk.
Saved 608 nouns to forced_to_become_the_heavenly_demon_ai.json
  Progress saved. Total nouns so far: 608

--- Processing AI chunk 2/2 ---
  Files: ['006.txt', '007.txt', '008.txt', '009.txt', '010.txt']
  Attempt 1/3 for AI discovery...
  AI discovered 4 new nouns in this chunk.
Saved 612 nouns to forced_to_become_the_heavenly_demon_ai.json
  Progress saved. Total nouns so far: 612

--- AI extraction complete ---
  Total AI-discovered nouns: 14
  Grand total nouns: 612

--- STEP 2b: Calculating frequencies and filtering ---

--- Performing frequency count across all files ---
  Total text length: 62,221 characters
  Frequency count complete.
  Removed 488 nouns with frequency 0

--- STEP 2c: Running ambiguity detection ---
Running ambiguity detection on 124 nouns...
Dictionary cache contains 266 entries
Ambiguity detection complete:
  - Total entries kept: 124
  - Ambiguous entries: 13
  - Dictionary cache now contains 266 entries
  - Ambiguity rate: 10.5%

--- Sorting nouns by ambiguity, length, and frequency ---
  Sorted 124 nouns
  Clear entries: 111, Ambiguous entries: 13
Saved 124 nouns to forced_to_become_the_heavenly_demon_ai.json

--- STEP 3: Categorizing nouns with AI ---

--- Starting AI categorization for 124 nouns ---
  Processing 50 nouns that need categorization
  Processing batch 1/1 (50 nouns)
--- AI categorization complete ---
Saved 124 nouns to forced_to_become_the_heavenly_demon_ai.json

--- STEP 4: Translating to English with AI ---

--- Starting AI translation for 50 nouns (skipping 74 already translated) ---
  Processing batch 1/1 (50 nouns)
--- AI translation complete ---
Saved 124 nouns to forced_to_become_the_heavenly_demon_ai.json

--- STEP 5: Guessing missing Hanja with AI ---
You chose not to guess missing Hanja with AI.

--- STEP 6: Converting to Simplified Chinese ---
You chose not to convert to Simplified Chinese.

--- STEP 7: Creating Excel file ---

Exporting to Excel files...
  Total entries: 124
  Full Glossary entries: 111
  ambiguous terms entries: 13

Creating master Excel file: forced_to_become_the_heavenly_demon_ai_master.xlsx
  - Full Glossary entries: 111 rows
  - ambiguous terms entries: 13 rows
  âœ“ Master file created successfully

Creating main Excel file: forced_to_become_the_heavenly_demon_ai.xlsx
  - character names: 12 entries, total frequency: 123
  - character titles: 27 entries, total frequency: 339
  - skills and techniques: 29 entries, total frequency: 192
  - locations and organizations: 22 entries, total frequency: 170
  - item names: 1 entries, total frequency: 7
  - misc: 20 entries, total frequency: 203
  - Ambiguous terms: 13 entries
  âœ“ Main file created successfully with 6 category worksheet(s)

ðŸ“Š Final Statistics:
   Total nouns: 124
   - character names: 12 entries, total frequency: 123
   - character titles: 27 entries, total frequency: 339
   - skills and techniques: 29 entries, total frequency: 192
   - locations and organizations: 22 entries, total frequency: 170
   - item names: 1 entries, total frequency: 7
   - misc: 20 entries, total frequency: 203
   - Ambiguous terms: 13 entries

============================================================
NOVEL GLOSSARY MAKER COMPLETED SUCCESSFULLY!
============================================================

