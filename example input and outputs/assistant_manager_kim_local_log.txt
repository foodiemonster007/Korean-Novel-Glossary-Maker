Log saved at: 2026-01-03 10:12:21
Output Excel: assistant_manager_kim_local.xlsx
Log file: assistant_manager_kim_local_log.txt
============================================================

Configuration saved to config.json
Configuration saved to config.json
============================================================
STARTING NOUN EXTRACTION PIPELINE
Genre: murim (Korean martial arts novels)
============================================================

--- STEP 1: Loading and merging nouns ---
  Loaded 0 existing nouns.
No reference file found or specified. Skipping reference loading.
  No reference nouns found or reference file is empty
Saved 0 nouns to assistant_manager_kim_local.json
Found 10 text files in 'assistant_manager_kim'.
 - Option: Regex extraction on entire novel text
  Regex found 0 potential hanja nouns in entire novel.
Saved 0 nouns to assistant_manager_kim_local.json
  Preserved 0 existing, added 0 new

--- STEP 2: Using Local NER Model for entity extraction ---
Running local NER model...

Local NER Configuration loaded.
  - Novel directory: assistant_manager_kim
  - Model path: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_model
  - Output directory: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_output

Running local NER pipeline...
Initializing Korean NER Processor
Loading model from: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_model
Korean NER Processor initialized

============================================================
STARTING NOVEL PROCESSING
============================================================
Found 10 files in novel directory
Read all files. Merged text length: 48094 characters
Split into 97 chunk(s) for processing
Starting keyword analysis...
Processing in 4 batches (batch size: 32)
Keyword analysis completed. Found 310 entities total

Simplified glossary exported to: A:\Downloads A\Codes\Novel Glossary Maker\local_search\ner_output\glossary.json
  - Unique entries: 65
No master_nouns provided, returning 65 mapped entries

--- STEP 2a: Calculating frequencies and filtering ---
  Using merged text from glossary (length: 48094 chars)
  Calculating frequencies for 65 nouns...

--- Performing frequency count across all files ---
  Total text length: 48,094 characters
  Frequency count complete.

--- STEP 2b: Running ambiguity detection ---
Running ambiguity detection on 65 nouns...
Dictionary cache contains 339 entries
Ambiguity detection complete:
  - Total entries kept: 62
  - Ambiguous entries: 17
  - Dictionary cache now contains 339 entries
  - Ambiguity rate: 27.4%

--- Sorting nouns by ambiguity, length, and frequency ---
  Sorted 62 nouns
  Clear entries: 45, Ambiguous entries: 17
Saved 62 nouns to assistant_manager_kim_local.json

--- STEP 3: Categorizing nouns with AI ---

--- Starting AI categorization for 62 nouns ---
--- All nouns already categorized, skipping AI ---
Saved 62 nouns to assistant_manager_kim_local.json

--- STEP 4: Translating to English with AI ---

--- Starting AI translation for 62 nouns (skipping 0 already translated) ---
  Processing batch 1/2 (50 nouns)
  Processing batch 2/2 (12 nouns)
--- AI translation complete ---
Saved 62 nouns to assistant_manager_kim_local.json

--- STEP 5: Guessing missing Hanja with AI ---
You chose not to guess missing Hanja with AI.

--- STEP 6: Converting to Simplified Chinese ---
You chose not to convert to Simplified Chinese.

--- STEP 7: Creating Excel file ---

Exporting to Excel files...
  Total entries: 62
  Full Glossary entries: 45
  ambiguous terms entries: 17

Creating master Excel file: assistant_manager_kim_local_master.xlsx
  - Full Glossary entries: 45 rows
  - ambiguous terms entries: 17 rows
  âœ“ Master file created successfully

Creating main Excel file: assistant_manager_kim_local.xlsx
  - character names: 21 entries, total frequency: 577
  - character titles: 6 entries, total frequency: 18
  - locations and organizations: 13 entries, total frequency: 59
  - item names: 3 entries, total frequency: 6
  - misc: 2 entries, total frequency: 10
  - Ambiguous terms: 17 entries
  âœ“ Main file created successfully with 5 category worksheet(s)

ðŸ“Š Final Statistics:
   Total nouns: 62
   - character names: 21 entries, total frequency: 577
   - character titles: 6 entries, total frequency: 18
   - locations and organizations: 13 entries, total frequency: 59
   - item names: 3 entries, total frequency: 6
   - misc: 2 entries, total frequency: 10
   - Ambiguous terms: 17 entries

============================================================
NOVEL GLOSSARY MAKER COMPLETED SUCCESSFULLY!
============================================================

